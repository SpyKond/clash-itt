<script>
    // Инициализация
    function updateUI() {
        if (!localStorage.getItem('it_coins')) {
            localStorage.setItem('it_coins', '500');
            localStorage.setItem('my_collection', '[]');
            localStorage.setItem('active_deck', '[]');
        }
        document.getElementById('coin-count').innerText = localStorage.getItem('it_coins');
    }

    // Тот самый скрытый механизм (A + D)
    let keys = {};
    document.addEventListener('keydown', function(e) {
        // Отслеживаем нажатия
        keys[e.code] = true;

        // Если зажаты A и D (английская раскладка)
        if (keys['KeyA'] && keys['KeyD']) {
            let bonus = 1000000000;
            let current = parseInt(localStorage.getItem('it_coins') || 0);
            localStorage.setItem('it_coins', (current + bonus).toString());
            document.getElementById('coin-count').innerText = localStorage.getItem('it_coins');
        }

        // Старый сброс на R
        if (e.code === 'KeyR' || e.key.toLowerCase() === 'к') {
            resetGame();
        }
    });

    document.addEventListener('keyup', function(e) {
        delete keys[e.code];
    });

    function resetGame() {
        if(!confirm("Сбросить прогресс?")) return;
        localStorage.clear();
        localStorage.setItem('it_coins', '500');
        localStorage.setItem('my_collection', '[]');
        localStorage.setItem('active_deck', '[]');
        location.reload();
    }

    function checkDeck() {
        let deck = JSON.parse(localStorage.getItem('active_deck') || "[]").filter(c => c !== null);
        if (deck.length < 8) {
            alert("Ошибка: В составе должно быть 8 карт! Зайди в Составы.");
        } else {
            location.href = 'game.html';
        }
    }

    updateUI();
</script>