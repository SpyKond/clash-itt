<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Clash Of IT - –°–æ—Å—Ç–∞–≤—ã</title>
    <style>
        body { 
            background: #050505; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; 
            display: flex; flex-direction: column; align-items: center; 
            user-select: none; /* –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª–æ –∫–ª–∏–∫–∞–º */
            -webkit-user-select: none;
        }
        .header { width: 100%; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; width: 95%; max-width: 600px; padding: 10px; }
        
        .card { 
            background: #1a1a1a; border: 2px solid #333; border-radius: 12px; 
            padding: 10px; text-align: center; position: relative; 
            cursor: pointer; transition: 0.2s;
            touch-action: manipulation; /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª–æ–∫ */
        }
        /* –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è –¥–ª—è –º–æ–±–∏–ª–æ–∫ */
        .card:active { transform: scale(0.95); background: #222; }
        
        .card.active { border-color: #00fbff; box-shadow: 0 0 15px rgba(0,251,255,0.4); background: #002b2e; }
        .card b { display: block; font-size: 14px; margin-top: 5px; pointer-events: none; }
        .card span { font-size: 10px; color: #aaa; text-transform: uppercase; pointer-events: none; }
        .rat { position: absolute; top: 5px; left: 5px; font-weight: bold; color: gold; font-size: 14px; pointer-events: none; }
        
        .deck-info { background: #111; width: 100%; padding: 15px; text-align: center; border-bottom: 2px solid #222; position: sticky; top: 0; z-index: 100; }
        .btn-back { background: #444; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="deck-info">
    <div style="display:flex; justify-content: space-between; align-items: center; max-width: 600px; margin: 0 auto; width: 100%;">
        <button class="btn-back" onclick="window.location.href='index.html'">–ú–ï–ù–Æ</button>
        <div style="font-size: 14px;">–í –°–û–°–¢–ê–í–ï: <b id="deck-count" style="color:#00fbff; font-size: 18px;">0</b> / 8</div>
    </div>
</div>

<h3 style="margin: 20px 0 10px 0; color: #aaa; text-transform: uppercase; font-size: 14px;">–¢–≤–æ—è –∫–æ–ª–ª–µ–∫—Ü–∏—è</h3>
<div id="collection-grid" class="grid"></div>

<script>
    let collection = JSON.parse(localStorage.getItem('my_collection') || "[]");
    let activeDeck = JSON.parse(localStorage.getItem('active_deck') || "[]");

    function render() {
        const grid = document.getElementById('collection-grid');
        grid.innerHTML = "";
        
        if (collection.length === 0) {
            grid.innerHTML = "<p style='grid-column: 1/-1; color: #555;'>–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç. –ó–∞–π–¥–∏ –≤ –º–∞–≥–∞–∑–∏–Ω!</p>";
            return;
        }

        collection.forEach(card => {
            const isActive = activeDeck.some(c => c.id === card.id);
            const cardEl = document.createElement('div');
            cardEl.className = `card ${isActive ? 'active' : ''}`;
            
            // –¶–≤–µ—Ç–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏
            if(card.rarity === '—Ä–µ–¥–∫–∏–π') cardEl.style.borderColor = '#2196F3';
            if(card.rarity === '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π') cardEl.style.borderColor = 'gold';

            cardEl.innerHTML = `
                <div class="rat">${card.rating}</div>
                <div style="font-size:32px; margin-bottom: 5px;">üë§</div>
                <b>${card.name}</b>
                <span>${card.class}</span>
            `;
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º touchend –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö
            cardEl.addEventListener('touchend', (e) => {
                e.preventDefault(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑—É–º/–≤—ã–¥–µ–ª–µ–Ω–∏–µ
                toggleCard(card);
            });

            // –û—Å—Ç–∞–≤–ª—è–µ–º onclick –¥–ª—è –ü–ö
            cardEl.addEventListener('click', (e) => {
                // –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞—á-—Å–æ–±—ã—Ç–∏–µ, —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–ª–∏–∫
                if (e.pointerType !== 'touch') toggleCard(card);
            });

            grid.appendChild(cardEl);
        });
        
        document.getElementById('deck-count').innerText = activeDeck.length;
    }

    function toggleCard(card) {
        const index = activeDeck.findIndex(c => c.id === card.id);
        if (index > -1) {
            activeDeck.splice(index, 1);
        } else {
            if (activeDeck.length >= 8) {
                // –í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫, –µ—Å–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç
                if (navigator.vibrate) navigator.vibrate(100);
                return;
            }
            activeDeck.push(card);
        }
        localStorage.setItem('active_deck', JSON.stringify(activeDeck));
        render();
    }

    render();
</script>
</body>
</html>