<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Clash Of IT - –ú–∞–≥–∞–∑–∏–Ω</title>
    <style>
        body { background: #050505; color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; }
        .header { width: 100%; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        #main-content { width: 100%; display: flex; flex-direction: column; align-items: center; padding: 20px; transition: 0.5s; }
        
        .pack-container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; margin-top: 30px; perspective: 1000px; }
        .pack-card { width: 140px; height: 210px; position: relative; transform-style: preserve-3d; transition: transform 0.6s; cursor: pointer; }
        .pack-card.flipped { transform: rotateY(180deg); }
        .pack-front, .pack-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 15px; border: 2px solid #333; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #111; }
        .pack-back { transform: rotateY(180deg); background: #1a1a1a; font-size: 12px; padding: 10px; box-sizing: border-box; text-align: center; }
        
        #opening-overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 2000; background: rgba(0,0,0,0.9); flex-direction: column; }
        .flip-container { width: 240px; height: 340px; perspective: 1000px; }
        .flipper { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .pack-opening, .card-result { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 20px; border: 4px solid #fff; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; }
        .card-result { transform: rotateY(180deg); background: #222; }

        .shaking { animation: shake 0.1s infinite; }
        @keyframes shake { 0%{transform:translate(2px,1px)} 50%{transform:translate(-2px,-1px)} 100%{transform:translate(0)} }
        
        @keyframes flash-pulse { 0% { background-color: rgba(0,0,0,0.9); } 30% { background-color: var(--p-col); } 100% { background-color: rgba(0,0,0,0.95); } }
        .do-flash { animation: flash-pulse 0.8s ease-out forwards; }
        .btn-claim { background: #2196F3; color: white; padding: 15px 40px; border: none; border-radius: 12px; margin-top: 30px; font-weight: bold; cursor: pointer; display: none; }
    </style>
</head>
<body>

<div id="main-content">
    <div class="header">
        <button onclick="window.location.href='index.html'" style="background:#444; color:white; border:none; padding:10px 20px; border-radius:10px; cursor:pointer;">–ù–ê–ó–ê–î</button>
        <div style="color:gold; font-size: 24px; font-weight: bold;">üí∞ <span id="coins-val">500</span></div>
    </div>
    <h1 style="text-align:center;">–ú–ê–ì–ê–ó–ò–ù</h1>
    <div id="starter-section" style="width: 100%; display: flex; justify-content: center; margin-bottom: 20px;"></div>
    
    <div class="pack-container">
        <div class="pack-card" oncontextmenu="this.classList.toggle('flipped'); return false;" onclick="buyPack('common', 150)" style="border: 2px solid #8b4513; border-radius: 15px;">
            <div class="pack-front"><span>üì¶</span><b>–û–ë–´–ß–ù–´–ô</b><p>150 C</p></div>
            <div class="pack-back"><b>–®–ê–ù–°–´:</b><br>–û–±—ã—á–Ω—ã–π: 90%<br>–†–µ–¥–∫–∏–π: 10%</div>
        </div>
        <div class="pack-card" oncontextmenu="this.classList.toggle('flipped'); return false;" onclick="buyPack('epic', 300)" style="border: 2px solid #e040fb; border-radius: 15px;">
            <div class="pack-front"><span>üíé</span><b>–≠–ü–ò–ß–ï–°–ö–ò–ô</b><p>300 C</p></div>
            <div class="pack-back"><b>–®–ê–ù–°–´:</b><br>–†–µ–¥–∫–∏–π: 80%<br>–≠–ø–∏–∫: 20%</div>
        </div>
        <div class="pack-card" oncontextmenu="this.classList.toggle('flipped'); return false;" onclick="buyPack('legend', 500)" style="border: 2px solid gold; border-radius: 15px;">
            <div class="pack-front"><span>üëë</span><b>–õ–ï–ì–ï–ù–î–ê</b><p>500 C</p></div>
            <div class="pack-back"><b>–®–ê–ù–°–´:</b><br>–≠–ø–∏–∫: 70%<br>–õ–µ–≥–µ–Ω–¥–∞: 30%</div>
        </div>
    </div>
</div>

<div id="opening-overlay">
    <div class="flip-container" onclick="handlePackClick()">
        <div id="flipper" class="flipper">
            <div id="pack-visual" class="pack-opening">
                <h2 id="pack-label" style="text-align:center;">–ù–ê–ñ–ú–ò –ù–ê –ü–ê–ö</h2>
                <div id="pack-icon" style="font-size: 80px;">üì¶</div>
            </div>
            <div id="card-result" class="card-result">
                <div id="c-rat" style="position:absolute; top:20px; left:20px; font-size:32px; font-weight:bold; color:gold;"></div>
                <h2 id="c-name" style="margin-bottom:5px;">–ò–ú–Ø</h2>
                <p id="c-class" style="color:#00fbff; font-weight:bold; margin:0;"></p>
                <p id="c-rarity" style="margin-top:15px; font-size:14px; text-transform:uppercase; color:#aaa;"></p>
            </div>
        </div>
    </div>
    <button id="claim-btn" class="btn-claim" onclick="window.location.reload()">–ó–ê–ë–†–ê–¢–¨ –ö–ê–†–¢–£</button>
</div>

<script>
    // 1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–º–µ–Ω
    const MY_CHARS = [
        {n:"–ú–∞–Ω—Å—É—Ä", c:"–∞—Ä–º–∏—è", r:"–æ–±—ã—á–Ω—ã–π"}, {n:"–ê–∫—ã–ª–∂–∞–Ω", c:"–º–µ–¥–∏–∫", r:"–æ–±—ã—á–Ω—ã–π"},
        {n:"–ù—É—Ä–∞—Å—ã–ª", c:"—Ç—É—Ä–µ–ª—å", r:"–æ–±—ã—á–Ω—ã–π"}, {n:"–ï—Ä–∞—Å—ã–ª", c:"–ª–µ—Ç—É–Ω", r:"–æ–±—ã—á–Ω—ã–π"},
        {n:"–ú–∞–∫—Å–∞—Ç", c:"–ª—É—á–Ω–∏–∫", r:"–æ–±—ã—á–Ω—ã–π"}, {n:"–î–∏–º–∞—à", c:"–±–ª–∏–∂–Ω–∏–∫", r:"—Ä–µ–¥–∫–∏–π"},
        {n:"–¢–µ–º–∏—Ä–ª–∞–Ω", c:"—Ç–∞–Ω–∫", r:"–æ–±—ã—á–Ω—ã–π"}, {n:"–°–∞–Ω–∂–∞—Ä", c:"—Ä–æ–π", r:"–æ–±—ã—á–Ω—ã–π"}
    ];

    // 2. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    let coins = parseInt(localStorage.getItem('it_coins') || 500);
    document.getElementById('coins-val').innerText = coins;

    let currentCard = null;
    let isOpening = false;

    // 3. –ü–æ–∫—É–ø–∫–∞ –ø–∞–∫–∞
    function buyPack(type, price) {
        if(coins < price) { alert("–ú–∞–ª–æ –º–æ–Ω–µ—Ç!"); return; }
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –ü–ï–†–ï–î –æ—Ç–∫—Ä—ã—Ç–∏–µ–º
        let randChar = MY_CHARS[Math.floor(Math.random() * MY_CHARS.length)];
        let rarity = (type === 'legend') ? '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π' : (type === 'epic' ? '—Ä–µ–¥–∫–∏–π' : randChar.r);
        let rating = (rarity === '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π') ? 92 : (rarity === '—Ä–µ–¥–∫–∏–π' ? 82 : 70);
        
        currentCard = {
            name: randChar.n,
            class: randChar.c,
            rarity: rarity,
            rating: rating,
            id: Date.now() + Math.random()
        };

        coins -= price;
        localStorage.setItem('it_coins', coins);
        document.getElementById('coins-val').innerText = coins;
        
        setupOverlay(type);
    }

    // 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —ç–∫—Ä–∞–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
    function setupOverlay(type) {
        isOpening = false;
        const overlay = document.getElementById('opening-overlay');
        const packVisual = document.getElementById('pack-visual');
        const flipper = document.getElementById('flipper');
        
        flipper.style.transform = "rotateY(0deg)";
        packVisual.classList.remove('shaking');
        overlay.classList.remove('do-flash');
        
        document.getElementById('pack-icon').innerText = (type==='common')?"üì¶":(type==='epic')?"üíé":"üëë";
        packVisual.style.borderColor = (type==='common')?"#8b4513":(type==='epic')?"#e040fb":"gold";

        document.getElementById('main-content').style.filter = 'blur(10px)';
        overlay.style.display = 'flex';
        document.getElementById('claim-btn').style.display = 'none';
        document.getElementById('pack-label').innerText = "–ù–ê–ñ–ú–ò –ù–ê –ü–ê–ö";
    }

    // 5. –ö–ª–∏–∫ –ø–æ –ø–∞–∫—É (–ê–Ω–∏–º–∞—Ü–∏—è)
    function handlePackClick() {
        if(isOpening || !currentCard) return;
        isOpening = true;

        const visual = document.getElementById('pack-visual');
        const overlay = document.getElementById('opening-overlay');
        const flipper = document.getElementById('flipper');
        
        // –ü—É–ª—å—Å —Ü–≤–µ—Ç–∞
        let pColor = currentCard.rarity === '—Ä–µ–¥–∫–∏–π' ? 'rgba(33,150,243,0.7)' : (currentCard.rarity === '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π' ? 'rgba(255,215,0,0.7)' : 'rgba(139,69,19,0.7)');
        overlay.style.setProperty('--p-col', pColor);
        overlay.classList.add('do-flash');
        visual.classList.add('shaking');

        // –ñ–¥–µ–º 2 —Å–µ–∫—É–Ω–¥—ã –∏ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º
        setTimeout(() => {
            visual.classList.remove('shaking');
            
            // –í—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞—Ä—Ç—É –ì–ê–†–ê–ù–¢–ò–†–û–í–ê–ù–ù–û
            document.getElementById('c-name').innerText = currentCard.name || "–ì–µ—Ä–æ–π";
            document.getElementById('c-class').innerText = (currentCard.class || "–±–ª–∏–∂–Ω–∏–∫").toUpperCase();
            document.getElementById('c-rat').innerText = currentCard.rating || 70;
            document.getElementById('c-rarity').innerText = currentCard.rarity || "–æ–±—ã—á–Ω—ã–π";
            
            // –¶–≤–µ—Ç —Ä–∞–º–∫–∏ –∫–∞—Ä—Ç—ã
            let borderColor = "#8b4513";
            if(currentCard.rarity === '—Ä–µ–¥–∫–∏–π') borderColor = "#2196F3";
            if(currentCard.rarity === '–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π') borderColor = "gold";
            document.getElementById('card-result').style.borderColor = borderColor;

            // –ü–æ–≤–æ—Ä–æ—Ç
            flipper.style.transform = "rotateY(180deg)";
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
            let col = JSON.parse(localStorage.getItem('my_collection') || "[]");
            col.push(currentCard);
            localStorage.setItem('my_collection', JSON.stringify(col));

            setTimeout(() => { document.getElementById('claim-btn').style.display = 'block'; }, 600);
        }, 2000);
    }

    // 6. –ù–∞—á–∞–ª—å–Ω—ã–π –ø–∞–∫
    function renderStarter() {
        const sec = document.getElementById('starter-section');
        let col = JSON.parse(localStorage.getItem('my_collection') || "[]");
        if(col.length === 0) {
            sec.innerHTML = `<div onclick="startFreePack()" style="width:90%; height:60px; background:#1a1a1a; border:2px dashed #00fbff; border-radius:15px; display:flex; align-items:center; justify-content:center; cursor:pointer; color:#00fbff; font-weight:bold;">üéÅ –ó–ê–ë–†–ê–¢–¨ –ù–ê–ß–ê–õ–¨–ù–´–ô –ù–ê–ë–û–† (8 –ö–ê–†–¢)</div>`;
        }
    }

    function startFreePack() {
        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É –¥–ª—è –ø–æ–∫–∞–∑–∞ (–î–∏–º–∞—à)
        currentCard = { name: "–î–∏–º–∞—à", class: "–±–ª–∏–∂–Ω–∏–∫", rarity: "—Ä–µ–¥–∫–∏–π", rating: 82, id: Date.now() };
        
        // –°–æ–∑–¥–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤–µ—Å—å –Ω–∞–±–æ—Ä –∏–∑ 8 —á–µ–ª–æ–≤–µ–∫ —Å—Ä–∞–∑—É
        let fullSet = MY_CHARS.map(c => ({
            name: c.n,
            class: c.c,
            rarity: c.r,
            rating: (c.r === '—Ä–µ–¥–∫–∏–π' ? 82 : 70),
            id: Math.random() + Date.now()
        }));
        
        localStorage.setItem('my_collection', JSON.stringify(fullSet));
        setupOverlay('common');
    }

    renderStarter();
</script>
</body>
</html>